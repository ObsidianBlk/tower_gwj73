extends Node3D
class_name ASpriteUnifiedPlayer3D


# ------------------------------------------------------------------------------
# Signals
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Constants and ENUMs
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Export Variables
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Variables
# ------------------------------------------------------------------------------
var _asprites : Dictionary = {}

# ------------------------------------------------------------------------------
# Onready Variables
# ------------------------------------------------------------------------------
func _ready() -> void:
	child_entered_tree.connect(_on_child_entered_tree)
	child_exiting_tree.connect(_on_child_exiting_tree)
	for child : Node in get_children():
		_on_child_entered_tree(child)

# ------------------------------------------------------------------------------
# Setters / Getters
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Override Methods
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Private Methods
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# Public Methods
# ------------------------------------------------------------------------------
func play(anim_name : StringName, custom_speed : float = 1.0, from_end : bool = false) -> void:
	for asprite : AnimatedSprite3D in _asprites.values():
		asprite.play(anim_name, custom_speed, from_end)

func stop() -> void:
	for asprite : AnimatedSprite3D in _asprites.values():
		asprite.stop()

# ------------------------------------------------------------------------------
# Handler Methods
# ------------------------------------------------------------------------------
func _on_child_entered_tree(child : Node) -> void:
	if child is AnimatedSprite3D:
		if not child.name in _asprites:
			_asprites[child.name] = child

func _on_child_exiting_tree(child : Node) -> void:
	if child.name in _asprites:
		_asprites.erase(child.name)
